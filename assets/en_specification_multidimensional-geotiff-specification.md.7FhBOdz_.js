import{_ as e}from"./chunks/geotiff.CHWrvXas.js";import{_ as a,c as t,a2 as s,o as n}from"./chunks/framework.9hYZJcoh.js";const o="/mrio/assets/content-gdal-ndim.VvJOv67t.svg",r="/mrio/assets/write_mode.BZq6Ydw1.gif",l="/mrio/assets/read_mode.CmDu49cQ.gif",k=JSON.parse('{"title":"The Multidimensional GeoTIFF","description":"","frontmatter":{},"headers":[],"relativePath":"en/specification/multidimensional-geotiff-specification.md","filePath":"en/specification/multidimensional-geotiff-specification.md"}'),d={name:"en/specification/multidimensional-geotiff-specification.md"};function h(p,i,c,m,g,u){return n(),t("div",null,i[0]||(i[0]=[s('<h1 id="the-multidimensional-geotiff" tabindex="-1">The Multidimensional GeoTIFF <a class="header-anchor" href="#the-multidimensional-geotiff" aria-label="Permalink to &quot;The Multidimensional GeoTIFF&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>While multidimensional array formats such as NetCDF, HDF5, and Zarr are supported by many GIS software and GDAL, their general-purpose design poses challenges for geospatial interoperability. These formats do not inherently default to explicit metadata conventions, such as coordinate reference systems, spatial dimensions, overviews or temporal attributes. As a result, users often need to manually configure spatial parameters during data ingestion, leading to inconsistent interpretations, projection mismatches, and additional preprocessing steps that complicate geospatial workflows.</p><p>The Multidimensional GeoTIFF (mGeoTIFF) specification extends the traditional GeoTIFF format to support N-dimensional arrays. It maintains the simplicity and compatibility of GeoTIFF, offers fast access and the ability to be opened by any GIS software or library that supports the GDALGeoTIFF format.</p><figure style="display:flex;flex-direction:column;align-items:center;"><img src="'+o+`" alt="Band GIF" style="width:60%;"></figure><h2 id="file-format-details" tabindex="-1">File format details <a class="header-anchor" href="#file-format-details" aria-label="Permalink to &quot;File format details&quot;">​</a></h2><p>This is the version <code>0.0.1</code> of the mGeoTIFF specification. From high-level perspective, main difference between a <a href="https://docs.ogc.org/is/19-008r4/19-008r4.html" target="_blank" rel="noreferrer">traditional GeoTIFF</a> and an mGeoTIFF is the addition of a TAG named as <strong><code>MD_METADATA</code></strong> that contains the metadata of the multidimensional array. With this metadata, client libraries can reshape the data from a 3D array (band, x, y) structure to an N-dimensional array.</p><p>The <code>MD_METADATA</code> tag is embedded within the <code>TIFFTAG_GDAL_METADATA</code> ASCII tag (code 42112), as recommended by the <a href="https://gdal.org/en/stable/drivers/raster/gtiff.html#metadata" target="_blank" rel="noreferrer">GDAL documentation</a> for handling non-standard metadata. This approach ensures compatibility with the GeoTIFF specification while enabling support for multidimensional arrays. The table below highlights the mandatory and optional fields within the <code>MD_METADATA</code> JSON structure:</p><table tabindex="0"><thead><tr><th>Field</th><th>Type</th><th>Required</th><th>Details</th></tr></thead><tbody><tr><td>md:pattern</td><td>string</td><td>Yes</td><td>A string defining the strategy to reshape the data into a 3D array (band, x, y). It is based on the Einstein-Inspired Notation for OPerationS, einops. The pattern is a space-separated list of dimension names, followed by an arrow <code>-&gt;</code>, and the new order of the dimensions. For example, <code>time band y x -&gt; (time band) y x</code> rearranges the dimensions from <code>(time, band, y, x)</code> to <code>time×band y x</code>, where <code>time×band</code> is a new number of channels. As GeoTIFF define explicitly the <code>y</code> and <code>x</code> dimensions, the pattern <strong>MUST</strong> always include them. There is no restriction on the number of dimensions. Refer to the <a href="https://openreview.net/pdf?id=oapKSVM2bcj" target="_blank" rel="noreferrer">einops paper</a> for more details about the notation.</td></tr><tr><td>md:coordinates</td><td>dictionary</td><td>Yes</td><td>A dictionary defining the coordinates to be combined with the pattern. The values <strong>MUST</strong> be lists of data types compliant with the <a href="https://www.json.org/json-en.html" target="_blank" rel="noreferrer">JSON standard</a>.</td></tr><tr><td>md:attributes</td><td>dictionary</td><td>No</td><td>A dictionary of additional metadata attributes to include in the file. It <strong>MUST</strong> complies with the <a href="https://www.json.org/json-en.html" target="_blank" rel="noreferrer">JSON standard</a>.</td></tr><tr><td>md:dimensions</td><td>list</td><td>No</td><td>A list of dimension names, where the order <strong>MUST</strong> align with the order specified in <code>md:pattern</code> before the arrow <code>-&gt;</code>.</td></tr><tr><td>md:coordinates_len</td><td>dictionary</td><td>No</td><td>A dictionary defining the length of each dimension. The values <strong>MUST</strong> be integers. It is created automatically when it is not provided.</td></tr></tbody></table><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h2><p>The following is an example of the <code>MD_METADATA</code> tag in a mGeoTIFF file:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;md:pattern&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;time band y x -&gt; (time band) y x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;md:coordinates&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2021-01-01&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2021-01-02&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2021-01-03&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;band&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B01&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B02&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B03&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;md:dimensions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;band&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;md:attributes&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;title&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Multidimensional GeoTIFF Example&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;description&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;This is a toy example of a Multidimensional GeoTIFF file.&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;md:coordinates_len&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;time&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;band&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;lat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;lon&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="how-the-i-o-works" tabindex="-1">How the I/O works <a class="header-anchor" href="#how-the-i-o-works" aria-label="Permalink to &quot;How the I/O works&quot;">​</a></h2><h3 id="writing" tabindex="-1">Writing <a class="header-anchor" href="#writing" aria-label="Permalink to &quot;Writing&quot;">​</a></h3><p>To simplify the explanation of how the I/O works, we will reference the Python API of <a href="https://github.com/tacofoundation/mrio" target="_blank" rel="noreferrer">mrio</a>. When writing an mGeoTIFF file, users must define the <code>MD_METADATA</code> tag as a dictionary. This dictionary is validated using Python dataclass fields (<a href="https://github.com/tacofoundation/mrio-python/blob/main/mrio/fields.py" target="_blank" rel="noreferrer">validation details</a>) and then converted to a JSON string. Refer to the mrio <a href="https://https://tacofoundation.github.io/mrio/en/python/examples.html" target="_blank" rel="noreferrer">Python examples</a> for guidance on writing an mGeoTIFF file.</p><figure style="display:flex;flex-direction:column;align-items:center;"><img src="`+r+`" alt="Band GIF" style="width:70%;"><figcaption style="text-align:center;"><b>Figure 1:</b> Writing an nD Array to a GDAL GeoTIFF Using mrio.</figcaption></figure><p>By default, all <code>mrio</code> files are created as Cloud-Optimized GeoTIFFs (COGs) without overviews. The default creation options are as follows:</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">creation_options </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;COMPRESS=DEFLATE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;TILED=YES&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;BLOCKXSIZE=128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;BLOCKYSIZE=128&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;INTERLEAVE=TILE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;BIGTIFF=YES&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;OVERVIEWS=NONE&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p>Arrays of arbitrary dimensions are reshaped into a 3D array (band, y, x) using the <code>md:pattern</code> field. With the <code>INTERLEAVE=TILE</code> option (check to our post about <a href="https://juliocontrerash.github.io/mrio_try_page/en/specification/cog.html#file-requirements" target="_blank" rel="noreferrer">COGs</a>), data is compressed into <code>1 × BLOCKXSIZE × BLOCKYSIZE</code> tiles and arranged contiguously along the band dimension.</p><p>In a 4-D array, the <code>md:pattern</code> can be defined in two ways.</p><ul><li><p>In the case <code>time band y x -&gt; (time band) y x</code>, data is stored continuously by band within each time step, such as: <code>b1time1, b2time1, ..., b1time2, b2time2, ..., b1time3, b2time3, ....</code></p></li><li><p>In the case <code>time band y x -&gt; (band time) y x</code>, data is stored continuously by time within each band, such as: <code>b1time1, b1time2, ..., b2time1, b2time2, ..., b3time1, b3time2, ....</code></p></li></ul><p>Data providers with large time dimensions (e.g., daily satellite imagery spanning decades) might prefer the band-time interleave layout. This approach ensures temporal byte continuity within the file, enabling efficient retrieval of time-series data. Specifically, requests for any length of time-series data can be fulfilled with just <strong>a single HTTP range request</strong>.</p><figure><img src="`+e+`" alt="GeoTIFF file structure" style="width:100%;"><figcaption style="text-align:center;"><b>Figure 2: </b>Writing a mGeoTIFF file.</figcaption></figure><p>By default, <code>mrio</code> generates band descriptions following the GDALGeoTIFF convention. These descriptions are stored in the <code>TIFFTAG_GDAL_METADATA</code> XML tag. The mrio band descriptions set names based on the <code>md:coordinates</code> key-value pairs. For example, given a 5D array with the <code>md:pattern</code> of <code>sim time band y x -&gt; (sim time band) y x</code>, the resulting band descriptions will be:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sim[0]__time[0]__band[0]</span></span>
<span class="line"><span>sim[0]__time[0]__band[1]</span></span>
<span class="line"><span>sim[0]__time[0]__band[2]</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>sim[0]__time[1]__band[0]</span></span>
<span class="line"><span>sim[0]__time[1]__band[1]</span></span>
<span class="line"><span>sim[0]__time[1]__band[2]</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>sim[1]__time[0]__band[0]</span></span>
<span class="line"><span>sim[1]__time[0]__band[1]</span></span>
<span class="line"><span>sim[1]__time[0]__band[2]</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>sim[1]__time[1]__band[0]</span></span>
<span class="line"><span>sim[1]__time[1]__band[1]</span></span>
<span class="line"><span>sim[1]__time[1]__band[2]</span></span></code></pre></div><p>Here, <code>sim[x]</code>, <code>time[y]</code>, and <code>band[z]</code> correspond to the names specified in the <code>md:coordinates</code> dictionary. The <code>__</code> separator is used to distinguish between dimensions. When dragging and dropping mGeoTIFF files into a GIS software, the band descriptions will be displayed as the band names.</p><figure><img src="`+e+'" alt="GeoTIFF file structure" style="width:100%;"><figcaption style="text-align:center;"><b>Figure 3: </b>Writing a mGeoTIFF file.</figcaption></figure><h3 id="reading" tabindex="-1">Reading <a class="header-anchor" href="#reading" aria-label="Permalink to &quot;Reading&quot;">​</a></h3><p>When reading an mGeoTIFF file, the <code>mrio</code> API reconstructs the original multidimensional array and metadata by reversing the transformations applied during the writing process.</p><figure style="display:flex;flex-direction:column;align-items:center;"><img src="'+l+'" style="width:70%;"><figcaption style="text-align:center;"><b>Figure 4: </b>Reading a GDAL GeoTIFF into an nD Array Using mrio.</figcaption></figure><p>The reconstruction involves the following steps:</p><ol><li><p><strong>Opening the File</strong>: The file is opened using the GDAL utility, and the <code>TIFFTAG_GDAL_METADATA</code> tag is accessed to retrieve the <code>MD_METADATA</code> JSON string.</p></li><li><p><strong>Parsing Metadata</strong>: The <code>MD_METADATA</code> string is parsed into a Python dictionary. Key fields, such as <code>md:pattern</code> and <code>md:coordinates</code>, are used to determine how the array should be reshaped to restore its original dimensions. Partial reads are supported, by <a href="https://github.com/tacofoundation/mrio-python/blob/708ce05b5cebbf38c2114399ed54c5b4b5769443/mrio/chunk_reader.py#L69" target="_blank" rel="noreferrer">vectorized operations</a>.</p></li><li><p><strong>Creating the Output</strong>: When the <code>engine</code> parameter is set to <code>xarray</code> (the default), the <code>md:attributes</code> field is also extracted. This enables the API to construct an <code>xarray.DataArray</code> object with the associated attributes and coordinates. Numpy rather than xarray is also supported.</p></li></ol><figure><img src="'+e+'" alt="GeoTIFF file structure" style="width:100%;"><figcaption style="text-align:center;"><b>Figure 5: </b>Writing a mGeoTIFF file.</figcaption></figure><h2 id="faq" tabindex="-1">FAQ <a class="header-anchor" href="#faq" aria-label="Permalink to &quot;FAQ&quot;">​</a></h2><h3 id="is-it-supported-by-qgis" tabindex="-1">Is it supported by QGIS? <a class="header-anchor" href="#is-it-supported-by-qgis" aria-label="Permalink to &quot;Is it supported by QGIS?&quot;">​</a></h3><p>If you open a mGeoTIFF file in QGIS, the software will display the special band names that are generated by <code>mrio</code>.</p><h3 id="is-it-supported-by-gdal" tabindex="-1">Is it supported by GDAL? <a class="header-anchor" href="#is-it-supported-by-gdal" aria-label="Permalink to &quot;Is it supported by GDAL?&quot;">​</a></h3><p>Not nativelly. However, as mGeoTIFF is a GeoTIFF file, it can be read by GDAL. That is actually what <code>mrio</code> does. It uses GDAL to read the file and then it virtually reshapes the data to the original shape.</p><h3 id="which-programming-languages-are-supported" tabindex="-1">Which programming languages are supported? <a class="header-anchor" href="#which-programming-languages-are-supported" aria-label="Permalink to &quot;Which programming languages are supported?&quot;">​</a></h3><p>The <code>mrio</code> API is currently available in Python. However, we have plans to support R and Julia in the future.</p><h3 id="can-i-use-it-with-tensorflow-or-pytorch" tabindex="-1">Can I use it with TensorFlow or PyTorch? <a class="header-anchor" href="#can-i-use-it-with-tensorflow-or-pytorch" aria-label="Permalink to &quot;Can I use it with TensorFlow or PyTorch?&quot;">​</a></h3><p>Yes, you can. Actually, we developed <code>mrio</code> to be used in our internal deep learning frameworks.</p><h3 id="why-not-use-netcdf-hdf5-or-zarr" tabindex="-1">Why not use NetCDF, HDF5, or Zarr? <a class="header-anchor" href="#why-not-use-netcdf-hdf5-or-zarr" aria-label="Permalink to &quot;Why not use NetCDF, HDF5, or Zarr?&quot;">​</a></h3><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><strong>A Personal Perspective:</strong> This reflects our views, not the Image &amp; Signal Processing Group at the University of Valencia. Many colleagues (including close friends!) actively advocate for <a href="https://www.youtube.com/watch?v=m345_TUjIdI" target="_blank" rel="noreferrer">NetCDF</a>. However, we have yet to find any Zarr enthusiasts within our group.</p></div><p><em>“Explicit is better than implicit.”</em> (<a href="https://peps.python.org/pep-0020/" target="_blank" rel="noreferrer">The Zen of Python</a>)</p><p>While there are many existing byte containers for multidimensional arrays, such as NetCDF, HDF5, and Zarr, our decision to use GeoTIFF stems from a combination of practical, technical, and community-based considerations:</p><ol><li><p><strong>Leverage Existing Tools and Expertise</strong>: There are many byte container formats available online. In theory, one could design a multidimensional array format using TIFF by saving each n-dimensional chunk in a separate IFD. With some effort, this approach could potentially achieve efficiency comparable to other n-dimensional array formats. However, by choosing the GDALGeoTIFF/COG layout <strong>all the necessary tools already exist</strong>. GDAL is highly optimized for working with COG files and is supported by a large, active community of experts continuously improving and maintaining it. Back to the example of an illusional n-D chunked TIFF format, it would not only require significant effort to develop but also writing a lot of code to ensure compatibility with other software (i.e. QGIS). In practice, the success of a format often depends more on the people supporting it than if a format is theoretically better than another.</p></li><li><p><strong>Stability and Maturity</strong>: GeoTIFF, in particular, has benefited from decades of development and refinement, making it a mature and highly stable format. This stability and maturity are key factors in its widespread adoption and reliability. One could argue that HDF5 is also &quot;stable.&quot; However, the key difference lies in its scope, HDF5 is an extremely ambitious project compared to GeoTIFF or Zarr. Maintaining its large number of features and extensions is a complex task. Check the <a href="https://support.hdfgroup.org/documentation/hdf5/latest/_f_m_t3.html" target="_blank" rel="noreferrer">HDF5 specification</a> to give you an idea of the complexity. Breaking changes between minor versions is very common, which can disrupt compatibility for software built on top of it, such as NetCDF. This complexity makes HDF5 less interoperable, specifically for less experienced users.</p></li><li><p><strong>Zarr&#39;s Promising Yet Nascent Approach</strong>:</p></li></ol><p>Zarr is another general-purpose format, it is relatively new and highly flexible, with a clear specification with fewer than 10 pages. In Zarr, almost everything except for the datatype, compression, shape, and chunk size is implicit. Instead of being a fully self-contained file format, Zarr operates more as a convention for organizing n-dimensional arrays in a folder structure. Zarr is cool but it can be very challenging to implement in an efficiency manner. Consider the case of a single Sentinel-2 scene 13x10980x10980 pixels, all the data with overviews included can be just one COG file. In Zarr, considering the same chunk size, it will be 24037 different files (we are not considering the overviews!). This is extremely inefficient and very costly in cloud storage. In a HTTP/2 context, GET operations that will cost 1 HTTP request in a COG, will cost hundreds/thousands in Zarr. However, with the introduction of sharding (<a href="https://zarr.dev/zeps/accepted/ZEP0002.html" target="_blank" rel="noreferrer">ZEP 2</a>), which enables chunk parsing, Zarr can partially solve this problem. Actually the Python <a href="https://github.com/zarr-developers/zarr-python" target="_blank" rel="noreferrer">Zarr API</a><br> and the other non-official Python <a href="https://github.com/ilan-gold/zarrs-python" target="_blank" rel="noreferrer">Zarr API</a> already support this feature. There are some geospatial initiatives like <a href="https://github.com/zarr-developers/geozarr-spec" target="_blank" rel="noreferrer">GeoZarr</a> but, they are very incipient.</p><p>As you can see, there is no perfect format for n-dimensional data. With mGeoTIFF, we aim to provide a simple, stable, and explicit format for n-dimensional arrays. By building on top the COG layout. However, there are some drawbacks to this approach that data providers should be aware of:</p><ol><li><p><strong>Hard to apply streaming operations</strong>, especially when user-defined overviews are involved. While not technically impossible, implementing streaming in mGeoTIFF is more complex compared to Zarr&#39;s chunked design, where this process is quite more straightforward.</p></li><li><p><strong>Limited support for complex nested data structures</strong>. It is not supported to store complex nested data structures in mGeoTIFF, like a list of n-dimensional arrays.</p></li><li><p><strong>Imposible to extent the chunking schema</strong>. In mGeoTIFF, the chunking schema is dimension fixed. This means that if you have a 4D array, you can only define the chunking schema as (1 x 1 x BLOCKXSIZE x BLOCKYSIZE) or (1 x C x BLOCKXSIZE x BLOCKYSIZE) if pixel interleave is used. Chunking schema is a natural feature in Zarr or NetCDF5. This limitation is critical because it will make larger in size with respect to Zarr or NetCDF5, specially when tehre is a lot of redundancy in the data.</p></li></ol><p>Despite these limitations, we believe that multidimensional GeoTIFF is currently the best option for many use cases. Whether you are creating a web map to visualize 10 years of changes in your village or building a deep learning dataset with multitemporal samples, mGeoTIFF provides a robust, mature, and reliable solution.</p>',51)]))}const b=a(d,[["render",h]]);export{k as __pageData,b as default};
